version: "0.1"
domain_id: "party-role"
domain_name: "Party Role Management Domain"
description: "Party Role Management domain manages store associate interface for order fulfillment and pickup processing. Handles QR code verification and order completion. Aligns with TMF ODA component TMF629 Party Role Management."

owner:
  name: "Zhong"
  role: "Technical Lead"
  team: "Engineering"

components:
  - id: "comp-party-role-management"
    name: "Party Role Management Service"
    description: "Manages store associate operations for order fulfillment, pickup processing, and QR code verification. Integrates with POS system for transaction recording."
    type: "stateful"
    code_paths:
      - "src/services/party-role/"
      - "src/api/party-role/"
      - "src/api/pickup/"
    external_dependencies:
      - name: "POS System"
        purpose: "Transaction recording, inventory query"
        protocol: "REST"
        availability_sla: "95.0%"
    provided_interfaces:
      - "ifc-party-role-api"
      - "ifc-pickup-api"
      - "ifc-pickup-event"
    consumed_interfaces:
      - "ifc-order-management-api"
      - "ifc-order-status-event"
      - "ifc-inventory-management-api"
      - "ifc-pos-integration"
    dependencies:
      - interface_id: "ifc-order-management-api"
        owner_domain: "order"
        required_before: "phase-1"
    nfr_slo:
      availability: "99.5%"
      latency_p95_ms: 200
      throughput_rps: 100
      error_budget: "0.5%"
    data_entities:
      - "Pickup Transaction"
      - "Fulfillment Queue"
    observability:
      metrics:
        - "fulfillment_api_latency"
        - "pickup_verification_latency"
        - "qr_code_scan_rate"
      logs:
        - "Fulfillment operation logs"
        - "Pickup verification logs"
        - "QR code scan logs"
      traces:
        - "Fulfillment operation traces"
        - "Pickup transaction traces"
    deployment:
      replicas: 2
      resource_limits:
        cpu: "2 vCPU"
        memory: "4Gi"
        storage: "10Gi"
      environment: "production"
    security:
      authentication: "mTLS"
      authorization: "Role-based (Associate, Manager)"
      data_encryption: "TLS 1.3 in transit, AES-256 at rest"
      compliance: "PCI DSS, GDPR"
    scaling:
      min_replicas: 2
      max_replicas: 6
      auto_scaling_trigger: "CPU > 60% for 5 minutes"
    interfaces:
      - "ifc-party-role-api"
      - "ifc-pickup-api"
      - "ifc-pickup-event"
    patterns:
      stateful_service: {}
      qr_code_verification: {}
      event_producer: {}

integration_patterns:
  - pattern: "sync_rest"
    source: "party-role"
    target: "order"
    interface: "ifc-party-role-api"
    resiliency:
      retries: 2
      timeout: "3000ms"
      circuit_breaker: true
    data_contract:
      version: "0.1.0"
      consistency: "strong"
  - pattern: "async_event"
    source: "party-role"
    target: "order"
    interface: "ifc-pickup-event"
    resiliency:
      retries: 3
      backoff: "exponential"
      dead_letter_queue: true
    data_contract:
      version: "0.1.0"
      backward_compatible: true

external_integrations:
  - system: "POS System"
    purpose: "Transaction recording, store operations"
    protocol: "REST"
    auth: "API_KEY"
    rate_limit: "100 rps"
    timeout: "5000ms"
    circuit_breaker: true
    notes: "POS system records BOPIS transactions and provides store inventory data"

open_questions: []

notes: "Party Role Management domain is store-associate facing and requires intuitive UI and low latency for pickup operations. QR code verification provides secure and fast order completion. Aligns with TMF ODA component TMF629 Party Role Management."
